<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>不要从单体应用开始 | 源代码</title>
  <meta name="google-site-verification" content="L7cNt2_aJoaEPcMgfBInN5d_XUuOW5DCDZBGzYp7rbE" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="baidu-site-verification" content="gvGfP4Z8md" />
  <meta name="description" content="Don’t start with a monolith
… when your goal is a microservices architecture
如果你的目标是微服务，就不要从单体应用开始。
In the last few months, I’ve heard repeatedly that the only way to get to a successful microservices">
<meta property="og:type" content="article">
<meta property="og:title" content="不要从单体应用开始">
<meta property="og:url" content="http://wenhao.github.io/2015/11/09/不要从单体应用开始/index.html">
<meta property="og:site_name" content="源代码">
<meta property="og:description" content="Don’t start with a monolith
… when your goal is a microservices architecture
如果你的目标是微服务，就不要从单体应用开始。
In the last few months, I’ve heard repeatedly that the only way to get to a successful microservices">
<meta property="og:updated_time" content="2015-11-17T09:30:07.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="不要从单体应用开始">
<meta name="twitter:description" content="Don’t start with a monolith
… when your goal is a microservices architecture
如果你的目标是微服务，就不要从单体应用开始。
In the last few months, I’ve heard repeatedly that the only way to get to a successful microservices">
  
  
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css" type="text/css">
  

  
  
<script type="text/javascript">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?c0ca8b0ebc2d1d2c71c7dc0611edd075";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

  <script src="//libs.baidu.com/jquery/2.0.3/jquery.min.js"></script>
  <script type="text/javascript" src="http://tajs.qq.com/stats?sId=47749856" charset="UTF-8"></script>
				
</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo"><i class="logo"></i><span class="site-title">源代码</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/categories">分类</a>
        
          <a class="main-nav-link" href="/tags">标签</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
      </nav>
      <nav id="sub-nav">
        <div class="profile" id="profile-nav">
          <a id="profile-anchor" href="javascript:;"><img class="avatar" src="/css/images/avatar.png"><i class="fa fa-caret-down"></i></a>
        </div>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="http://wenhao.github.io"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
      
        <td><a class="main-nav-link" href="/">首页</a></td>
      
        <td><a class="main-nav-link" href="/archives">归档</a></td>
      
        <td><a class="main-nav-link" href="/categories">分类</a></td>
      
        <td><a class="main-nav-link" href="/tags">标签</a></td>
      
        <td><a class="main-nav-link" href="/about">关于</a></td>
      
      <td>
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://wenhao.github.io"></form>
      </td>
      </tr>
    </table>
  </div>
</header>
    <div class="outer">
      <aside id="profile">
  <div class="inner profile-inner">
  	<div class="base-info profile-block">
		  <img id="avatar" src="/css/images/avatar.png">
      <h2 id="name">文浩</h2>
      <h3 id="title">技术经理</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Chengdu, China</span>
      <a id="follow" href="https://github.com/wenhao/" target="_blank">关注我</a>
  	</div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        9
        <span>文章</span>
      </div>
      <div class="article-info-block">
        14
        <span>标签</span>
      </div>
    </div>
    
    
        <div class="contact-info">
          <img class="qrcode" src="/css/images/webchat.JPG">
        </div>
        
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
        
          <td><a href="http://github.com/wenhao" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
        
          <td><a href="/#" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></td>
        
          <td><a href="/#" target="_blank" title="facebook"><i class="fa fa-facebook"></i></a></td>
        
          <td><a href="/#" target="_blank" title="dribbble"><i class="fa fa-dribbble"></i></a></td>
        
          <td><a href="/atom.xml" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
        
        </tr>
      </table>
    </div>
    
  </div>
</aside>
      <section id="main"><article id="post-不要从单体应用开始" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      不要从单体应用开始
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/2015/11/09/不要从单体应用开始/">
    <time datetime="2015-11-09T14:18:15.000Z" itemprop="datePublished">2015年11月9日</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/翻译/">翻译</a>
  </div>

          
<div class="article-author"><i class="fa fa-user"></i>
  
  <a href="http://wenhao.github.io" title="文浩">文浩</a>
</div>
  

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      

        <p>Don’t start with a monolith</p>
<p>… when your goal is a microservices architecture</p>
<p>如果你的目标是微服务，就不要从单体应用开始。</p>
<p>In the last few months, I’ve heard repeatedly that the only way to get to a successful microservices architecture is by starting with a monolith first. To paraphrase Simon Brown: If you can’t build a well-structured monolith, what makes you think you can build a well-structured set of microservices? The most recent – and, as usual, very convincing – rendering of this argument comes from Martin Fowler on this very site. As I had a chance to comment on an earlier draft, I had some time to think about this. And I did, especially because I usually find myself in agreement with him, and some others whose views I typically share seemed to agree with him, too.</p>
<p>最近几个月里，我多次听说要成功架构微服务的唯一方法是从单体应用开始。用Simon Brown的话说：如果你不能构建一个架构清晰的单体应用，你怎么能相信你能构建一个架构清晰的微服务呢？最近在Martin Fowler的个人网站上对此话题也有所讨论。</p>
<p>I’m firmly convinced that starting with a monolith is usually exactly the wrong thing to do.</p>
<p>Starting to build a new system is exactly the time when you should be thinking about carving it up into pieces. I strongly disagree with the idea that you can postpone this, as expressed by Sam Newman, again someone I agree with 95% of the time:</p>
<p>I remain convinced that it is much easier to partition an existing, “brownfield” system than to do so up front with a new, greenfield system. You have more to work with. You have code you can examine, you can speak to people who use and maintain the system. You also know what ‘good’ looks like - you have a working system to change, making it easier for you to know when you may have got something wrong or been too aggressive in your decision making process.</p>
<p>— Sam Newman</p>
<a id="more"></a>
<p>In the majority of cases, it will be awfully hard, if not outright impossible, to cut up an existing monolith this way. (That doesn’t mean it’s always impossible, but that’s a topic for a future post.) There is some common ground in that I agree you should know the domain you’re building a system for very well before trying to partition it, though: In my view, the ideal scenario is one where you’re building a second version of an existing system.</p>
<p>If you are actually able to build a well-structured monolith, you probably don’t need microservices in the first place. Which is OK! I definitely agree with Martin: You shouldn’t introduce the complexity of additional distribution into your system if you don’t have a very good reason for doing so.</p>
<p>(So what would be a good reason? There are many, but to me the most important one is to allow for fast, independent delivery of individual parts within a larger system. Microservices’ main benefit, in my view, is enabling parallel development by establishing a hard-to-cross boundary between different parts of your system. By doing this, you make it hard – or at least harder – to do the wrong thing: Namely, connecting parts that shouldn’t be connected, and coupling those that need to be connected too tightly. In theory, you don’t need microservices for this if you simply have the discipline to follow clear rules and establish clear boundaries within your monolithic application; in practice, I’ve found this to be the case only very rarely.)</p>
<p>You might be tempted to assume there are a number of nicely separated microservices hiding in your monolith, just waiting to be extracted. In reality, though, it’s extremely hard to avoid creating lots of connections, planned and unplanned. In fact the whole point of the microservices approach is to make it hard to create something like this.</p>
<p>But if you start with a monolith, the parts will become extremely tightly coupled to each other. That’s the very definition of a monolith. The parts will rely on features of the platform they all use. They’ll communicate based on abstractions that are shared because they all use the same libraries. They’ll communicate using means that are only available when they are hosted in the same process. And these are only the technical aspects! Far worse than that, the parts will (almost) freely share domain objects, rely on the same, shared persistence model, assume database transactions are readily available so that there’s no need for compensation … Even the very fact that it’s easy to refactor things and move them around – all in the convenience of your IDE’s view of a single project – is what makes it extremely hard to cut things apart again. It’s extremely hard to split up an existing monolith into separate pieces.</p>
<p>I strongly believe – and experience from a number of our recent projects confirms this – that when you start out, you should think about the subsystems you build, and build them as independently of each other as possible. Of course you should only do this if you believe your system is large enough to warrant this. If it’s just you and one of your co-workers building something over the course of a few weeks, it’s entirely possible that you don’t.</p>
<p>But starting with an approach where you carve up your system into smaller parts, and treat each of them as a clearly separated, individual system with its own development, deployment, and delivery cycle, and (the possibility of) its own internal architecture, is a very powerful concept that can help you to deliver a system in the first place.</p>
<p>So is there any actual experience to back this up? Yes, there are a few systems we’ve been involved with recently that showed this concept to work – provided you tolerate the fact that what I’m talking about is more likely bigger than your typical microservice. The most prominent one is Otto.de, about which I did a talk together with their tech lead (and which you can read about in this nice write-up by one of their lead architects). But there are quite a few others as well, and I remain convinced it’s a good idea to start building a system using this approach – given you know the domain you’re building for really, really well.</p>
<p>But there is another lesson to be learned from this discussion, in my view – and it’s a more general one: Beware of architectural recipes that are too simple and too obvious. This one – start by carving up your domain into separate, independent parts – is no exception. Sometimes a monolith is preferable, sometime it’s not. If you decide to build things using a microservices approach, you need to be aware that while it will be a lot easier to make localized decisions in each individual part, it will be much harder to change the very boundaries that enable this. Refactoring in the small becomes easier, refactoring in the large becomes much harder.</p>
<p>As is always the case with architecture discussions, there is no way to get around the fact that you need to make that decision on your own, in each and every individual case.</p>

      
    </div>

    
      <div id="article-toc">
	<div id="article-toc-title">文章目录<div>←</div></div>
	<div id="article-toc-content">
		
	</div>
</div>
    
    <footer class="article-footer">
      <!-- 原分享代码 
      <a data-url="http://wenhao.github.io/2015/11/09/不要从单体应用开始/" data-id="cinuexp6j001amvt5rm4lgobz" class="article-share-link">分享到</a>
      -->
      <!-- 百度分享 -->
      <div class="bdsharebuttonbox article-baidu-share-link">
          <a href="#" class="bds_more" data-cmd="more">分享到</a>
      </div>
      <script>
          window._bd_share_config = {
              "common": {
                  "bdSnsKey": {},
                  "bdText": "",
                  "bdMini": "2",
                  "bdPic": "",
                  "bdStyle": "0",
                  "bdSize": "16"
              },
              "share": {}
          };
          with(document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = 'http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=' + ~(-new Date() / 36e5)];
      </script>
      <!-- 百度分享结束 -->
      
        <!-- 评论
        <a href="http://wenhao.github.io/2015/11/09/不要从单体应用开始/#ds-thread" class="article-comment-link">评论</a>
        -->
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Martin-Fowler/">Martin Fowler</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/微服务/">微服务</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/05/05/搭建Artifactory集群/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前一篇</strong>
      <div class="article-nav-title">
        
          搭建Artifactory集群
        
      </div>
    </a>
  
  
    <a href="/2015/11/02/REST-API版本控制/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title">REST API版本控制</div>
    </a>
  
</nav>

  
</article>


  <section id="comments">
     <div id="ds-thread" class="ds-thread" data-thread-key="http://wenhao.github.io/2015/11/09/不要从单体应用开始/" data-title="不要从单体应用开始" data-url="http://wenhao.github.io/2015/11/09/不要从单体应用开始/">
     </div>
  </section>
</section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul id="recent-post" class="">
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2016/05/05/搭建Artifactory集群/" class="thumbnail">
  
    <span style="background-image:url(/img/binary-repository-trends.png
)" alt="搭建Artifactory集群" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/devops/">devops</a></p>
              <p class="item-title"><a href="/2016/05/05/搭建Artifactory集群/" class="title">搭建Artifactory集群</a></p>
              <p class="item-date"><time datetime="2016-05-05T14:51:19.000Z" itemprop="datePublished">2016年05月5日</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/11/09/不要从单体应用开始/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/翻译/">翻译</a></p>
              <p class="item-title"><a href="/2015/11/09/不要从单体应用开始/" class="title">不要从单体应用开始</a></p>
              <p class="item-date"><time datetime="2015-11-09T14:18:15.000Z" itemprop="datePublished">2015年11月9日</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/11/02/REST-API版本控制/" class="thumbnail">
  
    <span style="background-image:url(/img/rest-api.png
)" alt="REST API版本控制" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/restful/">restful</a></p>
              <p class="item-title"><a href="/2015/11/02/REST-API版本控制/" class="title">REST API版本控制</a></p>
              <p class="item-date"><time datetime="2015-11-02T07:21:59.000Z" itemprop="datePublished">2015年11月2日</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/10/21/基于GeoHash+Redis实现LBS附近地点搜索/" class="thumbnail">
  
    <span style="background-image:url(/img/geohash.png
)" alt="基于GeoHash+Redis实现LBS附近地点搜索" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/geohash/">geohash</a></p>
              <p class="item-title"><a href="/2015/10/21/基于GeoHash+Redis实现LBS附近地点搜索/" class="title">基于GeoHash+Redis实现LBS附近地点搜索</a></p>
              <p class="item-date"><time datetime="2015-10-21T07:55:27.000Z" itemprop="datePublished">2015年10月21日</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/10/02/spring和kafka集成/" class="thumbnail">
  
    <span style="background-image:url(/img/kafka-logo.png
)" alt="spring和kafka集成" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/kafka/">kafka</a></p>
              <p class="item-title"><a href="/2015/10/02/spring和kafka集成/" class="title">spring和kafka集成</a></p>
              <p class="item-date"><time datetime="2015-10-02T02:27:35.000Z" itemprop="datePublished">2015年10月2日</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/devops/">devops</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/geohash/">geohash</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/kafka/">kafka</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/restful/">restful</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/互联网/">互联网+</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/翻译/">翻译</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/设计模式/">设计模式</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/API版本控制/">API版本控制</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Martin-Fowler/">Martin Fowler</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Robert-C-Martin/">Robert C. Martin</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/artifactory/">artifactory</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/devops/">devops</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/geohash/">geohash</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/">kafka</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lbs/">lbs</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/restful/">restful</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/互联网/">互联网+</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/微服务/">微服务</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/翻译/">翻译</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/API版本控制/" style="font-size: 10px;">API版本控制</a> <a href="/tags/Martin-Fowler/" style="font-size: 20px;">Martin Fowler</a> <a href="/tags/Robert-C-Martin/" style="font-size: 20px;">Robert C. Martin</a> <a href="/tags/artifactory/" style="font-size: 10px;">artifactory</a> <a href="/tags/devops/" style="font-size: 10px;">devops</a> <a href="/tags/geohash/" style="font-size: 10px;">geohash</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/lbs/" style="font-size: 10px;">lbs</a> <a href="/tags/restful/" style="font-size: 10px;">restful</a> <a href="/tags/互联网/" style="font-size: 10px;">互联网+</a> <a href="/tags/微服务/" style="font-size: 20px;">微服务</a> <a href="/tags/翻译/" style="font-size: 10px;">翻译</a> <a href="/tags/设计模式/" style="font-size: 10px;">设计模式</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 文浩<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="https://github.com/wenhao/hexo-theme-icarus">icarus</a>
    </div>
  </div>
</footer>
    

  <script>var duoshuoQuery = {short_name:"cdwenhao"};</script>
  <script src="http://static.duoshuo.com/embed.js"></script>



  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>
<script src="/js/menu-nav.js" type="text/javascript"></script>

  </div>
</body>
</html>